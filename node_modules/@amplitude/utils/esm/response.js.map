{"version":3,"file":"response.js","sourceRoot":"","sources":["../src/response.ts"],"names":[],"mappings":"AAAA,OAAO,EAAY,MAAM,EAAE,MAAM,kBAAkB,CAAC;AAEpD;;;;;;GAMG;AACH,MAAM,CAAC,IAAM,0BAA0B,GAAG,UAAC,QAAkB;IAC3D,IAAM,mBAAmB,GAAG,IAAI,GAAG,EAAU,CAAC;IAC9C,IAAI,QAAQ,CAAC,MAAM,KAAK,MAAM,CAAC,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE;QACjD,IAAA,KAAuD,QAAQ,CAAC,IAAI,EAAlE,yBAAuB,6BAAA,EAAE,yBAAuB,6BAAkB,CAAC;QAC3E,MAAM,CAAC,IAAI,CAAC,yBAAuB,CAAC,CAAC,OAAO,CAAC,UAAC,KAAa;;YACzD,IAAM,YAAY,SAAG,yBAAuB,CAAC,KAAK,CAAC,mCAAI,EAAE,CAAC;YAC1D,YAAY,CAAC,OAAO,CAAC,UAAC,KAAa;gBACjC,mBAAmB,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,IAAI,CAAC,yBAAuB,CAAC,CAAC,OAAO,CAAC,UAAC,KAAa;;YACzD,IAAM,YAAY,SAAG,yBAAuB,CAAC,KAAK,CAAC,mCAAI,EAAE,CAAC;YAC1D,YAAY,CAAC,OAAO,CAAC,UAAC,KAAa;gBACjC,mBAAmB,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;KACJ;IAED,OAAO,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,IAAI,EAAE,CAAC;AAChD,CAAC,CAAC","sourcesContent":["import { Response, Status } from '@amplitude/types';\n\n/**\n * Collects the invalid event indices off a HTTP API v2 response\n * and returns them in increasing order.\n *\n * @param response A Response from sending an event payload\n * @returns An concatenated array of indices\n */\nexport const collectInvalidEventIndices = (response: Response): Array<number> => {\n  const invalidEventIndices = new Set<number>();\n  if (response.status === Status.Invalid && response.body) {\n    const { eventsWithInvalidFields, eventsWithMissingFields } = response.body;\n    Object.keys(eventsWithInvalidFields).forEach((field: string) => {\n      const eventIndices = eventsWithInvalidFields[field] ?? [];\n      eventIndices.forEach((index: number) => {\n        invalidEventIndices.add(index);\n      });\n    });\n    Object.keys(eventsWithMissingFields).forEach((field: string) => {\n      const eventIndices = eventsWithMissingFields[field] ?? [];\n      eventIndices.forEach((index: number) => {\n        invalidEventIndices.add(index);\n      });\n    });\n  }\n\n  return Array.from(invalidEventIndices).sort();\n};\n"]}